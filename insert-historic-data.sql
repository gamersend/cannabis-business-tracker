-- Insert historic profit data from prof.json
-- Connect to cannabis_tracker database first

-- Insert July historic profits
INSERT INTO historic_profits (customer_name, profit, sale_date) VALUES
-- 5/7 data
('Bernard', 90, '2024-07-05'),
('Gorigo', 320, '2024-07-05'),
('Trapezy', 210, '2024-07-05'),
('Ryan', 650, '2024-07-05'),
('Jay', 160, '2024-07-05'),
('Ash', 40, '2024-07-05'),
('Alfie', 70, '2024-07-05'),
('Raw', 180, '2024-07-05'),
('Tucker', 10, '2024-07-05'),
('John doe', 65, '2024-07-05'),
('Dex fix', 200, '2024-07-05'),
('Declan', 115, '2024-07-05'),
('Gorgio', 250, '2024-07-05'),
('Shagii', 170, '2024-07-05'),
('Jay', 115, '2024-07-05'),
('James', 120, '2024-07-05'),
('Zac', 40, '2024-07-05'),
('Ash', 40, '2024-07-05'),
('Small via ash', 400, '2024-07-05'),
('Trife', 300, '2024-07-05'),
('Alfie', 70, '2024-07-05'),

-- 6/7 data
('Alfie', 70, '2024-07-06'),
('Jay', 125, '2024-07-06'),
('Dan', 790, '2024-07-06'),
('Legit su', 950, '2024-07-06'),
('Rasta', 160, '2024-07-06'),
('Candace', 20, '2024-07-06'),
('Liam', 70, '2024-07-06'),
('Jay', 160, '2024-07-06'),
('Fintin', 110, '2024-07-06'),
('Nick', 80, '2024-07-06'),
('Alfie', 70, '2024-07-06'),
('Cam', 115, '2024-07-06'),
('David', 95, '2024-07-06'),
('FC', 120, '2024-07-06'),
('Nick', 80, '2024-07-06'),
('British', 80, '2024-07-06'),
('Edward', 40, '2024-07-06'),
('Paras', 120, '2024-07-06'),

-- 7/7 data
('Raw', 230, '2024-07-07'),
('Ash', 40, '2024-07-07'),
('Raiz', 170, '2024-07-07'),
('Rawk', 115, '2024-07-07'),
('President', 65, '2024-07-07'),
('EL', 260, '2024-07-07'),
('Gus', 75, '2024-07-07'),
('Mattwood', 160, '2024-07-07'),
('Jay', 120, '2024-07-07'),
('Tucker', 45, '2024-07-07'),
('Bobby', 170, '2024-07-07'),
('Wonka', 30, '2024-07-07'),
('Raw', 140, '2024-07-07'),
('Raiz', 115, '2024-07-07'),

-- 8/7 data
('Ryan', 70, '2024-07-08'),
('Larissa', 140, '2024-07-08'),
('Gracie', 60, '2024-07-08'),
('Bernard', 90, '2024-07-08'),
('Leaves', 120, '2024-07-08'),
('Trife', 300, '2024-07-08'),
('No vapes', 150, '2024-07-08'),
('Ash', 40, '2024-07-08'),
('Nick', 80, '2024-07-08'),
('Bernard', 70, '2024-07-08'),
('Zac', 40, '2024-07-08'),

-- 9/7 data
('Cancan', 320, '2024-07-09'),
('Cam', 150, '2024-07-09'),
('Bobby', 160, '2024-07-09'),
('Nick', 70, '2024-07-09'),
('Online', 190, '2024-07-09'),
('Leaves', 115, '2024-07-09'),
('Shagi', 170, '2024-07-09'),

-- 10/7 data
('Shagi', 170, '2024-07-10'),
('Rajib', 110, '2024-07-10'),

-- 11/7 data
('Cal', 120, '2024-07-11'),
('Liam', 110, '2024-07-11');

-- August data (26/7 - 16/8)
('Wonka', 30, '2024-07-26'),
('Ryan', 150, '2024-07-26'),
('Raw', 110, '2024-07-26'),
('Tyson', 120, '2024-07-26'),
('Trapzey', 150, '2024-07-27'),
('Nick', 75, '2024-07-27'),
('Cam', 60, '2024-07-27'),
('Alane', 120, '2024-07-28'),
('Dan', 150, '2024-07-28'),
('Dixon', 200, '2024-07-28'),
('Cam', 60, '2024-07-29'),
('Marcus', 140, '2024-07-29'),
('Online', 240, '2024-07-29'),
('Leaves', 105, '2024-07-30'),
('Ryan', 60, '2024-07-30'),
('Bernard', 450, '2024-07-30'),
('Darby', 70, '2024-07-31'),
('Online', 100, '2024-07-31'),
('Oren', 190, '2024-07-31'),
('Rahil', 75, '2024-08-02'),
('Online', 165, '2024-08-02'),
('Mitre', 220, '2024-08-02'),
('Shagi', 90, '2024-08-02'),
('Ryan', 650, '2024-08-03'),
('Rawk', 105, '2024-08-03'),
('Trife', 300, '2024-08-03'),
('Zac', 40, '2024-08-04'),
('Trife', 1200, '2024-08-04'),
('Trife', 500, '2024-08-04'),
('Trife', 300, '2024-08-04'),
('Raw', 110, '2024-08-05'),
('Ashewoo', 70, '2024-08-05'),
('Trife', 300, '2024-08-06'),
('Cam', 100, '2024-08-06'),
('Wonka', 35, '2024-08-06'),
('Teilgher', 100, '2024-08-06'),
('Luke', 120, '2024-08-07'),
('Alfie', 60, '2024-08-07'),
('Trapzey', 290, '2024-08-07'),
('Shagii', 350, '2024-08-09'),
('David', 110, '2024-08-10'),
('Online', 700, '2024-08-10'),
('Wonka', 70, '2024-08-10'),
('Jay', 70, '2024-08-11'),
('Ash', 400, '2024-08-11'),
('Online', 650, '2024-08-12'),
('Gorgio', 120, '2024-08-12'),
('David', 120, '2024-08-13'),
('Ash', 45, '2024-08-13'),
('Rawk', 140, '2024-08-14'),
('Nick', 85, '2024-08-14'),
('Rawk', 110, '2024-08-14'),
('Shagi', 190, '2024-08-15'),
('Wonka', 140, '2024-08-15'),
('Cam', 70, '2024-08-15'),
('Larissa', 130, '2024-08-16'),
('Ash', 45, '2024-08-16'),
('Christia', 115, '2024-08-16'),
('Rajib', 50, '2024-08-16');

-- Create aggregated customer records from historic data
INSERT INTO customers (name, total_profit, total_transactions, customer_type)
SELECT
    customer_name,
    SUM(profit),
    COUNT(*),
    CASE
        WHEN SUM(profit) >= 1000 THEN 'whale'
        WHEN SUM(profit) >= 500 THEN 'vip'
        ELSE 'regular'
    END
FROM historic_profits
GROUP BY customer_name
ON CONFLICT DO NOTHING;
